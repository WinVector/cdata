<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Control Table Keys • cdata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Control Table Keys">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cdata.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/blocksrecs.html">Block Records and Row Records</a>
    </li>
    <li>
      <a href="../articles/control_table_keys.html">Control Table Keys</a>
    </li>
    <li>
      <a href="../articles/design.html">Designing Transforms for Data Reshaping with cdata</a>
    </li>
    <li>
      <a href="../articles/exercises.html">cdata Exercises</a>
    </li>
    <li>
      <a href="../articles/general_transform.html">General Data Transforms With cdata</a>
    </li>
    <li>
      <a href="../articles/operators.html">Operators</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://www.win-vector.com/">Sponsor: Win-Vector LLC</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Control Table Keys</h1>
                        <h4 class="author">John Mount</h4>
            
            <h4 class="date">2020-01-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/WinVector/cdata/blob/master/vignettes/control_table_keys.Rmd"><code>vignettes/control_table_keys.Rmd</code></a></small>
      <div class="hidden name"><code>control_table_keys.Rmd</code></div>

    </div>

    
    
<p>In our <a href="https://github.com/WinVector/cdata"><code>cdata</code></a> <a href="https://www.r-project.org"><code>R</code></a> package and training materials we emphasize the <a href="https://winvector.github.io/cdata/articles/blocksrecs.html">record-oriented thinking</a> and <a href="https://winvector.github.io/cdata/articles/design.html">how to design a transform control table</a>. We now have an additional exciting new feature: control table keys.</p>
<p>The user can now control which columns of a <code>cdata</code> control table are the keys, including now using composite keys (that is keys that are spread across more than one column). This is easiest to demonstrate with an example.</p>
<p>Consider the simple data frame (the first couple of rows of the famous <code>iris</code> data set).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"cdata"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">d &lt;-<span class="st"> </span>wrapr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/wrapr/man/build_frame.html">build_frame</a></span>(</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">   <span class="st">"Sepal.Length"</span>  , <span class="st">"Sepal.Width"</span>, <span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span>, <span class="st">"Species"</span> <span class="op">|</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st">     </span><span class="fl">5.1</span>           , <span class="fl">3.5</span>          , <span class="fl">1.4</span>           , <span class="fl">0.2</span>          , <span class="st">"setosa"</span>  <span class="op">|</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="st">     </span><span class="fl">4.9</span>           , <span class="dv">3</span>            , <span class="fl">1.4</span>           , <span class="fl">0.2</span>          , <span class="st">"setosa"</span>  )</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">d<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(d))</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(d)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
<th align="right">id</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>Suppose we wish to land the dimensions of different irises in rows keyed by two columns: <code>Part</code> and <code>Measure</code>. That is we want the data to look like the following.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">expect &lt;-<span class="st"> </span>wrapr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/wrapr/man/build_frame.html">build_frame</a></span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">   <span class="st">"id"</span>  , <span class="st">"Species"</span>, <span class="st">"Part"</span> , <span class="st">"Measure"</span>, <span class="st">"Value"</span> <span class="op">|</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">     </span>1L  , <span class="st">"setosa"</span> , <span class="st">"Sepal"</span>, <span class="st">"Length"</span> , <span class="fl">5.1</span>     <span class="op">|</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">     </span>1L  , <span class="st">"setosa"</span> , <span class="st">"Sepal"</span>, <span class="st">"Width"</span>  , <span class="fl">3.5</span>     <span class="op">|</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st">     </span>1L  , <span class="st">"setosa"</span> , <span class="st">"Petal"</span>, <span class="st">"Length"</span> , <span class="fl">1.4</span>     <span class="op">|</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="st">     </span>1L  , <span class="st">"setosa"</span> , <span class="st">"Petal"</span>, <span class="st">"Width"</span>  , <span class="fl">0.2</span>     <span class="op">|</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="st">     </span>2L  , <span class="st">"setosa"</span> , <span class="st">"Sepal"</span>, <span class="st">"Length"</span> , <span class="fl">4.9</span>     <span class="op">|</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="st">     </span>2L  , <span class="st">"setosa"</span> , <span class="st">"Sepal"</span>, <span class="st">"Width"</span>  , <span class="dv">3</span>       <span class="op">|</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="st">     </span>2L  , <span class="st">"setosa"</span> , <span class="st">"Petal"</span>, <span class="st">"Length"</span> , <span class="fl">1.4</span>     <span class="op">|</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="st">     </span>2L  , <span class="st">"setosa"</span> , <span class="st">"Petal"</span>, <span class="st">"Width"</span>  , <span class="fl">0.2</span>     )</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(expect)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="left">Species</th>
<th align="left">Part</th>
<th align="left">Measure</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Length</td>
<td align="right">5.1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Width</td>
<td align="right">3.5</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Length</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Width</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Length</td>
<td align="right">4.9</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Width</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Length</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Width</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
<p>This may seem like an exotic transform, but it seems to be common when you want to use multiple display aesthetics in a plot (such as x, y, color, and facet).</p>
<p>With multiple control table keys specifying these sorts of transforms can be made easy.</p>
<p>First define the control table specifying what a single row-record looks like after transformation to a multi-row block-record.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">control_table &lt;-<span class="st"> </span>wrapr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/wrapr/man/qchar_frame.html">qchar_frame</a></span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">   <span class="st">"Part"</span>   , <span class="st">"Measure"</span>, <span class="st">"Value"</span>      <span class="op">|</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">     "Sepal"</span>, <span class="st">"Length"</span> , Sepal.Length <span class="op">|</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">     "Sepal"</span>, <span class="st">"Width"</span>  , Sepal.Width  <span class="op">|</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">     "Petal"</span>, <span class="st">"Length"</span> , Petal.Length <span class="op">|</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">     "Petal"</span>, <span class="st">"Width"</span>  , Petal.Width  )</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">layout &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rowrecs_to_blocks_spec.html">rowrecs_to_blocks_spec</a></span>(</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  control_table,</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  <span class="dt">controlTableKeys =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Part"</span>, <span class="st">"Measure"</span>),</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  <span class="dt">recordKeys =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="st">"Species"</span>))</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(layout)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;  row_record &lt;- wrapr::qchar_frame(</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;    "id"  , "Species", "Sepal.Length", "Sepal.Width", "Petal.Length", "Petal.Width" |</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;      .   , .        , Sepal.Length  , Sepal.Width  , Petal.Length  , Petal.Width   )</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;  row_keys &lt;- c('id', 'Species')</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;  # becomes</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;  block_record &lt;- wrapr::qchar_frame(</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt;    "id"  , "Species", "Part" , "Measure", "Value"      |</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt;      .   , .        , "Sepal", "Length" , Sepal.Length |</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt;      .   , .        , "Sepal", "Width"  , Sepal.Width  |</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt;      .   , .        , "Petal", "Length" , Petal.Length |</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt;      .   , .        , "Petal", "Width"  , Petal.Width  )</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt;  block_keys &lt;- c('id', 'Species', 'Part', 'Measure')</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt;  # args: c(checkNames = TRUE, checkKeys = FALSE, strict = FALSE, allow_rqdatatable = TRUE)</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; }</span></a></code></pre></div>
<p>Notice we are specifying that the columns <code>Part</code> and <code>Measure</code> are the control table row-keys (identifying rows within the block record) and “id” and “Species” are record keys (specifying which rows are in the same record).</p>
<p>We have designed our desired transform above (as taught <a href="https://winvector.github.io/cdata/articles/design.html">here</a>). We are introducing a new convention of putting the key values in quotes (even though <code>wrapr::qcar_frame()</code> does not need this). Notice the quoted fields are column-names of the original row-oriented data, and the quote is indicating that these are names standing in for values.</p>
<p>We can now perform the transform.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">res &lt;-<span class="st"> </span>d <span class="op">%.&gt;%</span><span class="st"> </span>layout</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(res)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="left">Species</th>
<th align="left">Part</th>
<th align="left">Measure</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Length</td>
<td align="right">5.1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Width</td>
<td align="right">3.5</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Length</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Width</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Length</td>
<td align="right">4.9</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Width</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Length</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Width</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
<p>And, as one comes to expect with coordinatized/fluid-data transforms, the process is easy to reverse (modulo column and row order).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">inv_layout &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(layout)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(inv_layout)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;  block_record &lt;- wrapr::qchar_frame(</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;    "id"  , "Species", "Part" , "Measure", "Value"      |</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;      .   , .        , "Sepal", "Length" , Sepal.Length |</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;      .   , .        , "Sepal", "Width"  , Sepal.Width  |</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;      .   , .        , "Petal", "Length" , Petal.Length |</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;      .   , .        , "Petal", "Width"  , Petal.Width  )</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;  block_keys &lt;- c('id', 'Species', 'Part', 'Measure')</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;  # becomes</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;  row_record &lt;- wrapr::qchar_frame(</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;    "id"  , "Species", "Sepal.Length", "Sepal.Width", "Petal.Length", "Petal.Width" |</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;      .   , .        , Sepal.Length  , Sepal.Width  , Petal.Length  , Petal.Width   )</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;  row_keys &lt;- c('id', 'Species')</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt;  # args: c(checkNames = TRUE, checkKeys = FALSE, strict = FALSE, allow_rqdatatable = TRUE)</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"></a>
<a class="sourceLine" id="cb5-23" data-line-number="23">back &lt;-<span class="st"> </span>res <span class="op">%.&gt;%</span><span class="st"> </span>inv_layout</a>
<a class="sourceLine" id="cb5-24" data-line-number="24"></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(back)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="left">Species</th>
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
<p>Recle Etino Vibal (<a href="https://github.com/WinVector/cdata/issues/3">who asked for this feature in an issue</a>) has <a href="https://amateurdatasci.rbind.io/post/table-another-back-again-cdata/">an interesting article</a> trying some variations on the data shaping concepts.</p>
<p>The <code>cdata</code> unit test include the following variations of the above example:</p>
<ul>
<li>
<a href="https://github.com/WinVector/cdata/blob/master/inst/unit_tests/test_there_and_back.R">A simple “there and back example”</a>.</li>
<li>
<a href="https://github.com/WinVector/cdata/blob/master/inst/unit_tests/test_there_and_back_db.R">The “there and back” example on a database</a>.</li>
<li>
<a href="https://github.com/WinVector/cdata/blob/master/inst/unit_tests/test_composite_control_keys.R">A composite control keys example</a> (this demo).</li>
<li>
<a href="https://github.com/WinVector/cdata/blob/master/inst/unit_tests/test_composite_control_keys_db.R">The composite control keys example on a database</a>.</li>
</ul>
<p>We think <code>cdata</code> (and the accompanying <a href="http://winvector.github.io/FluidData/FluidData.html">fluid data methodology</a>, plus <a href="https://winvector.github.io/cdata/articles/general_transform.html">extensions</a>) is a very deep and powerful way of wrangling data. Once you take the time to learn the methodology (which is “draw what you want to happen to one record, type that in as your control table, and you are done!”) it is very easy to use.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Mount, Nina Zumel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
